{% extends "base.html" %}

{% block content %}
  <div class="largetitle">Terms & Conditions</div>
  <p class="subtitle">Please review and accept our terms before booking</p>

  <!-- T&Cs Preview -->
  <div class="group">
    <div style="background:rgba(255,255,255,.04); border-radius:12px; padding:20px; border:1px solid var(--hair); margin-bottom:16px;">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; flex-wrap: wrap; gap: 12px;">
        <div style="flex: 1; min-width: 200px;">
          <div style="font-weight:700; font-size:16px; margin-bottom:4px;">
            {{ company.company_name }} - Terms & Conditions
          </div>
          <div style="font-size:13px; color:var(--muted);">
            Version {{ company.tcs_version }} ‚Ä¢ Last updated {{ company.tcs_updated_at.strftime('%d %B %Y') if company.tcs_updated_at else 'N/A' }}
          </div>
        </div>
      </div>

      <!-- PDF Embed -->
      <div style="background:#000; border-radius:8px; overflow:hidden; border:1px solid #333;">
        <iframe
          src="{{ company.tcs_document_url }}"
          style="width:100%; height:400px; border:none;"
          title="Terms and Conditions">
        </iframe>
      </div>

      <div style="margin-top:12px; text-align:center;">
        <a href="{{ company.tcs_document_url }}" target="_blank" style="color:#2ee59d; text-decoration:none; font-size:14px;">
          üìÑ Open full document in new tab ‚Üí
        </a>
      </div>
    </div>

    <!-- Acceptance Form -->
    <form method="POST" action="/s/{{ company_slug }}/{{ token }}/tcs/accept" style="margin-top:24px;">
      <label style="display:flex; align-items:start; padding:16px; border-radius:12px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1); cursor:pointer; margin-bottom:16px;">
        <input
          type="checkbox"
          name="accept_tcs"
          required
          style="margin-top:4px; margin-right:12px; width:20px; height:20px; flex-shrink:0;"
        >
        <div style="flex:1;">
          <div style="font-weight:600; margin-bottom:6px;">
            I have read and agree to the Terms & Conditions
          </div>
          <div style="font-size:13px; color:var(--muted); line-height:1.6;">
            By checking this box, I confirm that I have read, understood, and agree to be bound by the
            {{ company.company_name }} Terms & Conditions (Version {{ company.tcs_version }})
            for the removal service dated {{ job.move_date.strftime('%d %B %Y') if job.move_date else 'TBC' }}.
          </div>
        </div>
      </label>

      {% if error %}
      <div style="padding:12px; border-radius:8px; background:rgba(220,38,38,.1); border:1px solid rgba(220,38,38,.3); margin-bottom:16px; color:#dc2626; font-size:14px;">
        {{ error }}
      </div>
      {% endif %}

      <button type="submit" class="btn btn-primary btn-block">
        Accept & Continue to Booking
      </button>
    </form>

    <!-- Decline Option -->
    <div style="text-align:center; margin-top:16px;">
      <a href="/s/{{ company_slug }}/{{ token }}/quote-preview" style="color:#888; text-decoration:none; font-size:14px;">
        ‚Üê Back to quote
      </a>
    </div>
  </div>

  <!-- Legal Notice -->
  <div style="padding:16px; border-radius:8px; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.1); margin-top:24px;">
    <div style="font-size:12px; color:#666; line-height:1.6;">
      <strong style="color:#aaa;">Legal Notice:</strong> Your acceptance will be recorded with timestamp and IP address for legal compliance.
      This acceptance is binding and forms part of your contract with {{ company.company_name }}.
    </div>
  </div>
{% endblock %}
