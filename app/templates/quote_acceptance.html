{% extends "base.html" %}

{% block content %}
  <!-- Voice guidance for this page -->
  <div id="voiceGuidance" data-message="Almost done! Please review your quote details on screen. To accept, tick the checkbox at the bottom that says you accept the quote, then tap the green Accept Quote button." hidden></div>

  <div class="largetitle">Accept Your Quote</div>
  <p class="subtitle">Please review and accept your removal quote</p>

  <!-- Quote Summary -->
  <div class="group">
    <div style="font-weight:700; margin-bottom:16px; font-size:18px;">Your Moving Quote</div>

    <div style="background:rgba(46,229,157,.08); border-radius:12px; padding:20px; border:1px solid rgba(46,229,157,.2); margin-bottom:16px;">
      <div style="text-align:center; margin-bottom:12px;">
        {% if job.final_quote_price %}
        <div style="font-size:14px; color:var(--muted); margin-bottom:8px;">Your Quote</div>
        <div style="font-size:36px; font-weight:800; color:#2ee59d;">
          ¬£{{ job.final_quote_price }}
        </div>
        <div style="font-size:13px; color:rgba(46,229,157,.8); margin-top:6px;">Final price confirmed</div>
        {% else %}
        <div style="font-size:14px; color:var(--muted); margin-bottom:8px;">Estimated Cost</div>
        <div style="font-size:32px; font-weight:800; color:#2ee59d;">
          ¬£{{ quote.estimate_low }} ‚Äì ¬£{{ quote.estimate_high }}
        </div>
        {% endif %}
      </div>

      <div style="border-top:1px solid rgba(46,229,157,.2); padding-top:12px; margin-top:12px;">
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; font-size:14px;">
          <div style="text-align:center;">
            <div style="color:var(--muted); margin-bottom:4px;">Total Items</div>
            <div style="font-weight:700;">{{ quote.total_items }}</div>
          </div>
          <div style="text-align:center;">
            <div style="color:var(--muted); margin-bottom:4px;">Volume</div>
            <div style="font-weight:700;">{{ "%.2f"|format(quote.total_cbm) }} m¬≥</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Route Details -->
    <div style="margin-bottom:16px;">
      <div style="font-size:14px; color:var(--muted); margin-bottom:8px;">Moving From</div>
      <div style="font-weight:600; margin-bottom:12px;">
        {{ job.pickup.label if job.pickup else 'Not specified' }}
      </div>

      <div style="font-size:14px; color:var(--muted); margin-bottom:8px;">Moving To</div>
      <div style="font-weight:600;">
        {{ job.dropoff.label if job.dropoff else 'Not specified' }}
      </div>
    </div>

    <!-- Important Notice -->
    <div style="background:rgba(255,255,255,.05); border-radius:8px; padding:16px; border:1px solid rgba(255,255,255,.1);">
      <div style="font-weight:600; margin-bottom:8px; color:#60a5fa;">üìã What Happens Next</div>
      <div style="font-size:13px; color:var(--muted); line-height:1.6;">
        After accepting this quote:
        <ol style="margin:8px 0 0 20px; padding:0;">
          <li>You'll review and accept our Terms & Conditions</li>
          <li>You can take your time to confirm your final moving date with everyone involved</li>
          <li>When ready, return to complete booking and pay the deposit</li>
        </ol>
      </div>
    </div>
  </div>

  <!-- Acceptance Form -->
  <form method="POST" action="/s/{{ company_slug }}/{{ token }}/quote/accept" style="margin-top:24px;">
    <div class="group">
      <label style="display:flex; align-items:start; padding:16px; border-radius:12px; background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1); cursor:pointer;">
        <input
          type="checkbox"
          name="accept_quote"
          required
          style="margin-top:4px; margin-right:12px; width:20px; height:20px; flex-shrink:0;"
        >
        <div style="flex:1;">
          {% if job.final_quote_price %}
          <div style="font-weight:600; margin-bottom:6px;">
            I accept this quote of ¬£{{ job.final_quote_price }}
          </div>
          <div style="font-size:13px; color:var(--muted); line-height:1.6;">
            I confirm this is the agreed price for my move based on the information and photos provided.
            Additional services requested on moving day may incur extra charges.
          </div>
          {% else %}
          <div style="font-weight:600; margin-bottom:6px;">
            I accept this quote estimate
          </div>
          <div style="font-size:13px; color:var(--muted); line-height:1.6;">
            I understand this is an estimate based on the information and photos provided.
            The final price may vary depending on the actual volume and any additional services required on moving day.
          </div>
          {% endif %}
        </div>
      </label>

      {% if error %}
      <div style="padding:12px; border-radius:8px; background:rgba(220,38,38,.1); border:1px solid rgba(220,38,38,.3); margin-top:16px; color:#dc2626; font-size:14px;">
        {{ error }}
      </div>
      {% endif %}

      <button type="submit" class="btn btn-primary btn-block" style="margin-top:16px;">
        Accept Quote & Continue
      </button>
    </div>
  </form>

  <!-- Back Option -->
  <div style="text-align:center; margin-top:16px;">
    <a href="/s/{{ company_slug }}/{{ token }}/quote-preview" style="color:#888; text-decoration:none; font-size:14px;">
      ‚Üê Back to quote
    </a>
  </div>
{% endblock %}
