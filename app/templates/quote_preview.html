{% extends "base.html" %}

{% block content %}
  {% if auto_approved %}
    <div class="largetitle">âœ… Instant Quote Ready!</div>
    <p class="subtitle">Your quote is approved and ready to book â€” no waiting needed!</p>
  {% else %}
    <div class="largetitle">ğŸ’° Your Quote</div>
    <p class="subtitle">AI-powered estimate. Our team will review and confirm within 2 hours.</p>
  {% endif %}

  <div class="group">
    <div class="bigprice">Â£{{ estimate_low }} â€“ Â£{{ estimate_high }}</div>
    {% if auto_approved %}
      <div class="pill" style="background:rgba(46,229,157,.2); color:#2ee59d;">âœ… Approved</div>
    {% else %}
      <div class="pill">{{ confidence }}</div>
    {% endif %}

    <div style="margin-top:16px; padding-top:16px; border-top:1px solid var(--hair);">
      <div style="font-weight:700; margin-bottom:12px;">Move Summary</div>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <div class="statrow">
          <div class="staticon">ğŸ“¦</div>
          <div class="statrow-text">
            <span class="statrow-label">Items detected</span>
            <span class="statrow-value">{{ total_items }}</span>
          </div>
        </div>
        <div class="statrow">
          <div class="staticon">ğŸ </div>
          <div class="statrow-text">
            <span class="statrow-label">Property type</span>
            <span class="statrow-value">{{ job.property_type|title|replace('_', ' ') if job.property_type else 'Not specified' }}</span>
          </div>
        </div>
      </div>
      <div style="margin-top:12px; padding:12px; border-radius:8px; background:rgba(46,229,157,.08); font-size:13px; color:var(--muted);">
        ğŸ’¡ Our team will review your inventory and confirm the final quote within 2 hours
      </div>
    </div>

    <div style="margin-top:16px; padding-top:16px; border-top:1px solid var(--hair);">
      <div style="font-weight:700; margin-bottom:12px;">Route</div>
      <div style="display:flex; flex-direction:column; gap:8px;">
        <div class="statrow">
          <div class="staticon" style="background:rgba(46,229,157,.15);">
            <span style="font-size:12px;">ğŸ“</span>
          </div>
          <div style="flex:1; min-width:0;">
            <div style="font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; font-weight:600; margin-bottom:3px;">Pickup</div>
            <div style="font-size:14px; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">{{ job.pickup.label if job.pickup else "Not set" }}</div>
          </div>
        </div>
        <div class="statrow">
          <div class="staticon" style="background:rgba(255,77,79,.15);">
            <span style="font-size:12px;">ğŸ“</span>
          </div>
          <div style="flex:1; min-width:0;">
            <div style="font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; font-weight:600; margin-bottom:3px;">Delivery</div>
            <div style="font-size:14px; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">{{ job.dropoff.label if job.dropoff else "Not set" }}</div>
          </div>
        </div>
        {% if job.move_date %}
        <div class="statrow">
          <div class="staticon" style="background:rgba(46,229,157,.15);">
            <span style="font-size:12px;">ğŸ“…</span>
          </div>
          <div style="flex:1; min-width:0;">
            <div style="font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:0.5px; font-weight:600; margin-bottom:3px;">Moving Date</div>
            <div style="font-size:14px; font-weight:600;">{{ job.move_date.strftime('%A, %d %B %Y') }}</div>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}

{% block footer %}
  <div class="footer footer-clean">
    <div class="footer-inner">
      {% if auto_approved or job.status == 'approved' %}
        <a href="/s/{{ company_slug }}/{{ token }}/contact" class="btn" style="background:#00c853; color:#fff; text-decoration:none; display:block;">
          ğŸš€ Book Your Move Now
        </a>
        <div class="microhint" style="text-align:center; margin-top:8px;">
          Quote pre-approved â€¢ Secure your moving date instantly
        </div>
      {% elif job.status == 'in_progress' %}
        <form method="post" action="/s/{{ company_slug }}/{{ token }}/submit-quote">
          <button class="btn" type="submit">âœ“ Submit for Review</button>
          <div class="microhint" style="text-align:center; margin-top:8px;">
            Our team will confirm your quote within 2 hours
          </div>
        </form>
      {% elif job.status == 'awaiting_approval' %}
        <div style="text-align:center;">
          <div class="btn" style="opacity:.7; pointer-events:none; background:#ffa500; color:#000;">
            â³ Awaiting Approval
          </div>
          <div class="microhint" style="margin-top:8px;">
            We're reviewing your quote. You'll receive a text when it's ready!
          </div>
        </div>
      {% endif %}
      <a href="/s/{{ company_slug }}/{{ token }}/photos/bulk" class="btn secondary" style="margin-top:10px;">
        â† Upload More Photos
      </a>
    </div>
  </div>
{% endblock %}
