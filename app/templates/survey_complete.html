{% extends "base.html" %}

{% block content %}
  <!-- Voice guidance for this page -->
  <div id="voiceGuidance" data-message="That's your survey done! We've got a full inventory of everything you need moved. You can close this page now, or scroll down to review the summary." hidden></div>

  <div style="text-align:center; padding:40px 0 20px;">
    <div style="font-size:80px; margin-bottom:16px;">&#10003;</div>
    <div class="largetitle">Survey complete</div>
    <p class="subtitle">Your inventory has been recorded.</p>
  </div>

  <!-- Inventory Stats -->
  <div class="group">
    <div style="font-weight:700; margin-bottom:12px;">Inventory summary</div>
    <div style="display:flex; flex-direction:column; gap:8px;">
      <div class="statrow">
        <div class="staticon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
          </svg>
        </div>
        <div class="statrow-text">
          <span class="statrow-label">Total items</span>
          <span class="statrow-value">{{ total_items }}</span>
        </div>
      </div>
      <div class="statrow">
        <div class="staticon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="3" width="15" height="13"></rect>
            <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
          </svg>
        </div>
        <div class="statrow-text">
          <span class="statrow-label">Volume</span>
          <span class="statrow-value">{{ total_cbm }} m&sup3;</span>
        </div>
      </div>
      <div class="statrow">
        <div class="staticon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
        </div>
        <div class="statrow-text">
          <span class="statrow-label">Weight</span>
          <span class="statrow-value">{{ total_weight|int }} kg</span>
        </div>
      </div>
      {% if bulky_count > 0 %}
      <div class="statrow">
        <div class="staticon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            <path d="M2 17l10 5 10-5"></path>
            <path d="M2 12l10 5 10-5"></path>
          </svg>
        </div>
        <div class="statrow-text">
          <span class="statrow-label">Bulky items</span>
          <span class="statrow-value">{{ bulky_count }}</span>
        </div>
      </div>
      {% endif %}
      {% if fragile_count > 0 %}
      <div class="statrow">
        <div class="staticon">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
        </div>
        <div class="statrow-text">
          <span class="statrow-label">Fragile items</span>
          <span class="statrow-value">{{ fragile_count }}</span>
        </div>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- Room Breakdown -->
  {% if room_stats|length > 0 %}
  <div class="group">
    <div style="font-weight:700; margin-bottom:12px;">Rooms</div>
    <div class="invlist">
      {% for room in room_stats %}
        <div class="invlink" style="cursor:default;">
          <div class="invtop">
            <div class="invroom">{{ room.name }}</div>
            <div class="invmeta">{{ room.item_count }} item{{ 's' if room.item_count != 1 else '' }}</div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}

  <!-- Addresses -->
  {% if job.pickup or job.dropoff %}
  <div class="group">
    <div style="font-weight:700; margin-bottom:12px;">Locations</div>
    {% if job.pickup and job.pickup.label %}
    <div style="margin-bottom:12px;">
      <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Pickup</div>
      <div style="font-size:14px;">{{ job.pickup.label }}</div>
    </div>
    {% endif %}
    {% if job.dropoff and job.dropoff.label %}
    <div>
      <div style="font-size:12px; color:var(--muted); margin-bottom:4px;">Delivery</div>
      <div style="font-size:14px;">{{ job.dropoff.label }}</div>
    </div>
    {% endif %}
  </div>
  {% endif %}

  <!-- Reference -->
  <div class="group">
    <div style="font-weight:700; margin-bottom:12px;">Reference</div>
    <div style="background:var(--subtle-bg); border-radius:12px; padding:16px; border:1px solid var(--hair); text-align:center;">
      <div style="font-size:11px; color:var(--muted); margin-bottom:8px; text-transform:uppercase; letter-spacing:1px;">Survey Token</div>
      <div style="font-size:24px; font-weight:800; font-family:monospace; letter-spacing:2px;">
        {{ job.token[:8].upper() }}
      </div>
    </div>
  </div>
{% endblock %}

{% block footer %}
  <div class="footer footer-clean">
    <div class="footer-inner">
      <div class="microhint" style="text-align:center;">
        Survey recorded. You can close this page.
      </div>
    </div>
  </div>
{% endblock %}
